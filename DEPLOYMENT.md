# Deployment Guide

This guide covers different deployment options for the Mock Interview AI application.

## Quick Deploy Options

### Option 1: Replit (Recommended for beginners)

1. **Import to Replit**:
   - Go to [Replit](https://replit.com)
   - Click "Create Repl" → "Import from GitHub"
   - Enter your GitHub repository URL

2. **Set Environment Variables**:
   - Click on "Tools" → "Secrets" in your Repl
   - Add these secrets:
     ```
     DATABASE_URL=your_postgresql_connection_string
     GEMINI_API_KEY=your_gemini_api_key
     ```

3. **Deploy**:
   - Click the "Deploy" button in Replit
   - Your app will be available at `your-repl-name.username.repl.co`

### Option 2: Railway

1. **Connect GitHub**:
   - Go to [Railway](https://railway.app)
   - Sign in with GitHub
   - Click "New Project" → "Deploy from GitHub repo"

2. **Configure Environment**:
   - Add environment variables in Railway dashboard
   - Railway will automatically detect it's a Node.js app

3. **Deploy**:
   - Railway will automatically deploy on every push to main branch

### Option 3: Vercel

1. **Connect Repository**:
   - Go to [Vercel](https://vercel.com)
   - Import your GitHub repository
   - Vercel will auto-detect the framework

2. **Configure Build Settings**:
   - Build Command: `npm run build`
   - Output Directory: `dist`
   - Install Command: `npm install`

3. **Environment Variables**:
   - Add your environment variables in Vercel dashboard

## Manual Server Deployment

### Prerequisites
- Node.js 18+ installed
- PostgreSQL database
- PM2 for process management (optional)

### Steps

1. **Clone and Install**:
   ```bash
   git clone https://github.com/yourusername/mock-interview-ai.git
   cd mock-interview-ai
   npm install
   ```

2. **Environment Setup**:
   ```bash
   cp .env.example .env
   # Edit .env with your values
   ```

3. **Database Setup**:
   ```bash
   npm run db:push
   ```

4. **Build Application**:
   ```bash
   npm run build
   ```

5. **Start Production Server**:
   ```bash
   npm start
   ```

6. **Optional: Use PM2**:
   ```bash
   npm install -g pm2
   pm2 start npm --name "mock-interview-ai" -- start
   pm2 save
   pm2 startup
   ```

## Database Setup

### Neon (Recommended)

1. Create account at [Neon.tech](https://neon.tech)
2. Create new project
3. Copy connection string to environment variables

### Local PostgreSQL

1. Install PostgreSQL
2. Create database: `createdb mock_interview_ai`
3. Update DATABASE_URL in .env

## Environment Variables

Create `.env` file with:

```env
# Database
DATABASE_URL=postgresql://username:password@host:port/database

# AI Service
GEMINI_API_KEY=your_gemini_api_key_here

# App Configuration
NODE_ENV=production
PORT=5000

# Database Configuration (auto-generated by Neon)
PGHOST=your_pg_host
PGPORT=5432
PGDATABASE=your_database_name
PGUSER=your_username
PGPASSWORD=your_password
```

## Troubleshooting

### Common Issues

1. **Database Connection Error**:
   - Verify DATABASE_URL format
   - Check network connectivity
   - Ensure database server is running

2. **Gemini API Error**:
   - Verify API key is correct
   - Check API quota/limits
   - Ensure API key has proper permissions

3. **Build Errors**:
   - Clear node_modules and reinstall
   - Check Node.js version compatibility
   - Verify all dependencies are installed

### Debug Mode

Run with debug logging:
```bash
NODE_ENV=development npm start
```

## Performance Optimization

### Production Optimizations

1. **Enable gzip compression**:
   ```javascript
   app.use(compression());
   ```

2. **Set up reverse proxy (nginx)**:
   ```nginx
   server {
       listen 80;
       server_name yourdomain.com;
       
       location / {
           proxy_pass http://localhost:5000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
       }
   }
   ```

3. **Configure caching**:
   - Set proper cache headers
   - Use CDN for static assets
   - Implement Redis for session storage

## Security Considerations

1. **Environment Variables**:
   - Never commit .env files
   - Use secrets management in production
   - Rotate API keys regularly

2. **Database Security**:
   - Use connection pooling
   - Implement proper authentication
   - Regular security updates

3. **API Security**:
   - Implement rate limiting
   - Use HTTPS in production
   - Validate all inputs

## Monitoring

### Health Checks

The application includes basic health check endpoints:
- `GET /health` - Basic health check
- `GET /api/health` - API health check

### Logging

Configure logging for production:
```javascript
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});
```

## Scaling

### Horizontal Scaling

1. **Load Balancer**: Use nginx or cloud load balancer
2. **Database**: Use connection pooling
3. **Sessions**: Store in Redis instead of memory

### Vertical Scaling

1. **CPU**: Monitor CPU usage and increase as needed
2. **Memory**: Monitor memory usage, especially for speech processing
3. **Storage**: Monitor database size and optimize queries

## Backup Strategy

### Database Backups

1. **Automated Backups**:
   ```bash
   pg_dump $DATABASE_URL > backup_$(date +%Y%m%d_%H%M%S).sql
   ```

2. **Cloud Backups**:
   - Most cloud providers offer automatic backups
   - Set up regular backup schedules

### Application Backups

1. **Code Repository**: Ensure code is backed up to GitHub
2. **Environment Config**: Document all environment variables
3. **Static Assets**: Backup any uploaded files

## Support

For deployment issues:
1. Check the [Issues](https://github.com/yourusername/mock-interview-ai/issues) page
2. Review logs for error messages
3. Verify all environment variables are set correctly
4. Test database connectivity independently